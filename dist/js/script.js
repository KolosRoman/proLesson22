import{formContainer,login,password}from"./register.js";let userBlock=document.getElementById("user-block"),page1=document.getElementById("page1"),page2=document.getElementById("page2"),counter=1;function mainPage(){fetch("https://reqres.in/api/users?page="+counter).then(e=>e.json()).then(e=>{1===counter&&(e.data.map(e=>(e.name=e.first_name+" "+e.last_name,e)).forEach(e=>{var t=document.createElement("div"),a=document.createElement("h3"),n=document.createElement("p"),r=document.createElement("img"),i=document.createElement("p");i.innerText=e.id,i.classList.add("id-number"),r.alt="photo-user",a.innerText=e.name,a.classList.add("page-name"),n.innerText=e.email,n.classList.add("page-email"),r.src=e.avatar,t.append(a,n,r,i),t.classList.add("card-block"),page1.insertAdjacentElement("beforeend",t)}),userBlock.append(page1)),counter++}).catch(e=>console.log(e))}async function nextOpenPage(){if(2===counter){for(;page2.firstChild;)page2.firstChild.remove();try{(await(await fetch("https://reqres.in/api/users?page="+counter)).json()).data.map(e=>(e.name=e.first_name+" "+e.last_name,e)).forEach(e=>{var t=document.createElement("div"),a=document.createElement("h3"),n=document.createElement("p"),r=document.createElement("img"),i=document.createElement("p");i.innerText=e.id,i.classList.add("id-number"),r.alt="photo-user",a.innerText=e.name,a.classList.add("page-name"),n.innerText=e.email,n.classList.add("page-email"),r.src=e.avatar,t.append(a,n,r,i),t.classList.add("card-block"),page2.insertAdjacentElement("beforeend",t)}),userBlock.append(page2)}catch(e){console.log(e)}counter--}page1.classList.add("active"),page2.classList.remove("active")}async function lastOpenPage(){if(1===counter){for(;page1.firstChild;)page1.firstChild.remove();try{(await(await fetch("https://reqres.in/api/users?page="+counter)).json()).data.map(e=>(e.name=e.first_name+" "+e.last_name,e)).forEach(e=>{var t=document.createElement("div"),a=document.createElement("h3"),n=document.createElement("p"),r=document.createElement("img"),i=document.createElement("p");i.innerText=e.id,i.classList.add("id-number"),r.alt="photo-user",a.innerText=e.name,a.classList.add("page-name"),n.innerText=e.email,n.classList.add("page-email"),r.src=e.avatar,t.append(a,n,r,i),t.classList.add("card-block"),page1.insertAdjacentElement("beforeend",t)}),userBlock.append(page1)}catch(e){console.log(e)}counter++}page2.classList.add("active"),page1.classList.remove("active")}let inputName=document.getElementById("user-name"),inputSurname=document.getElementById("surname"),inputEmail=document.getElementById("email"),inputJob=document.getElementById("job"),inputId=document.getElementById("id-number"),createUsersBlock=document.getElementById("create-users"),errorMessage=document.getElementById("error");async function addNewUser(){if(inputName.value&&inputSurname.value&&inputEmail.value&&inputJob.value){var e=document.createElement("div"),t=document.createElement("h3"),a=document.createElement("p"),n=document.createElement("p"),r=document.createElement("p");try{var i={name:inputName.value,surname:inputSurname.value,email:inputEmail.value,job:inputJob.value},s=await(await fetch("https://reqres.in/api/users",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(i)})).json();a.innerText=s.id,a.classList.add("id-number"),t.innerText=s.name+" "+s.surname,t.classList.add("new-user-title"),n.innerText=s.email,n.classList.add("new-user-email"),r.innerText=s.job,r.classList.add("new-user-job"),e.append(a,t,n,r),e.classList.add("newCard"),createUsersBlock.append(e)}catch(e){console.log(e)}inputName.value="",inputSurname.value="",inputEmail.value="",inputJob.value="",errorMessage.innerText=""}else errorMessage.innerText="Всі поля мають бути заповнені"}function updateUser(){let l=inputId.value,c=document.getElementsByClassName("newCard"),m=document.getElementsByClassName("card-block");var e={name:inputName.value,surname:inputSurname.value,email:inputEmail.value,job:inputJob.value};fetch("https://reqres.in/api/users/"+l,{method:"PUT",headers:{"content-type":"application/json"},body:JSON.stringify(e)}).then(e=>{if(200===e.status)return e.json()}).then(e=>{for(var t of c){var a,n;t.querySelector(".id-number").innerText===l&&(e.name&&(a=t.querySelector(".new-user-title").innerText.split(" ")[0],a=t.querySelector(".new-user-title").innerText.replace(a,e.name),t.querySelector(".new-user-title").innerText=a),e.surname&&(a=t.querySelector(".new-user-title").innerText.split(" ")[1],n=t.querySelector(".new-user-title").innerText.replace(a,e.surname),t.querySelector(".new-user-title").innerText=n),e.email&&(t.querySelector(".new-user-email").innerText=e.email),e.job)&&(t.querySelector(".new-user-job").innerText=e.job)}for(var r of m){var i,s;r.querySelector(".id-number").innerText===l&&(e.name&&(i=r.querySelector(".page-name").innerText.split(" ")[0],i=r.querySelector(".page-name").innerText.replace(i,e.name),r.querySelector(".page-name").innerText=i),e.surname&&(i=r.querySelector(".page-name").innerText.split(" ")[1],s=r.querySelector(".page-name").innerText.replace(i,e.surname),r.querySelector(".page-name").innerText=s),e.email)&&(r.querySelector(".page-email").innerText=e.email)}}).catch(e=>console.log(e)),inputName.value="",inputSurname.value="",inputEmail.value="",inputJob.value="",inputId.value=""}async function deleteUser(){var e=inputId.value,t=document.getElementsByClassName("newCard"),a=document.getElementsByClassName("card-block");try{if(204===(await fetch("https://reqres.in/api/users/"+e,{method:"DELETE"})).status){for(var n of t)n.querySelector(".id-number").innerText===e&&n.remove();for(var r of a)r.querySelector(".id-number").innerText===e&&r.remove()}}catch(e){console.log(e)}inputId.value=""}function exit(){localStorage.removeItem("token"),formContainer.classList.remove("correct"),login.value="",password.value=""}export{mainPage,nextOpenPage,lastOpenPage,addNewUser,updateUser,deleteUser,exit};